exp_name=wsjmodel_nn5__2
alpha=1e-5
nn_layers=5
train_data=toJohn/wsj02-21.naacl_l2.vw 
#dev_data=../data/deps/wsj22.naacl_l.vw  
test_data_ori=toJohn/wsj23.naacl
test_data=toJohn/wsj23.naacl_l2.vw
tag=toJohn/tags
tmp_file=$exp_name.tmp
python_exe=python2.7


#vowpalwabbit/vw -k --passes 3 --save_per_pass --cache_file $exp_name.cache -d $train_data --search_rollin mix_per_roll --search_task dep_parser --search 12 --search_alpha $alpha  --search_rollout oracle  --holdout_off -f models/${exp_name} --search_history_length 3 --search_no_caching -b 26 --root_label 8 --num_label 12 --nn $nn_layers --ftrl --dparser_no_quad --dparser_no_cubic  -q `printf "\x43\x45"` -q `printf "\x43\x46"` -q `printf "\x44\x45"` -q `printf "\x44\x46"` -q `printf "\x43\x49"` -q `printf "\x43\x4a"` -q `printf "\x44\x49"` -q `printf "\x44\x4a"` -q `printf "\x43\x43"` -q `printf "\x43\x44"` -q `printf "\x44\x43"` -q `printf "\x44\x44"` -q `printf "\x45\x45"` -q `printf "\x45\x46"` -q `printf "\x46\x45"` -q `printf "\x46\x46"` -q `printf "\x47\x47"` -q `printf "\x47\x48"` -q `printf "\x48\x47"` -q `printf "\x48\x48"` -q `printf "\x49\x49"` -q `printf "\x49\x4a"` -q `printf "\x4a\x49"` -q `printf "\x4a\x4a"` -q `printf "\x4b\x4b"` -q `printf "\x4b\x4c"` -q `printf "\x4c\x4b"` -q `printf "\x4c\x4c"` -q `printf "\x4d\x4d"` -q `printf "\x4d\x4e"` -q `printf "\x4e\x4d"` -q `printf "\x4e\x4e"` -q `printf "\x49\x4b"` -q `printf "\x49\x4c"` -q `printf "\x4a\x4b"` -q `printf "\x4a\x4c"` -q `printf "\x43\x4f"` -q `printf "\x43\x50"` -q `printf "\x44\x4f"` -q `printf "\x44\x50"` -q `printf "\x43\x53"` -q `printf "\x43\x54"` -q `printf "\x44\x53"` -q `printf "\x44\x54"` -q `printf "\x49\x57"` -q `printf "\x49\x58"` -q `printf "\x4a\x57"` -q `printf "\x4a\x58"` -q `printf "\x64\x43"` -q `printf "\x64\x44"` -q `printf "\x64\x45"` -q `printf "\x64\x46"` -q `printf "\x64\x47"` -q `printf "\x64\x48"` -q `printf "\x64\x49"` -q `printf "\x64\x4a"` -q `printf "\x64\x4b"` -q `printf "\x64\x4c"` -q `printf "\x64\x4d"` -q `printf "\x64\x4e"` -q `printf "\x64\x64"` --cubic `printf "\x49\x4b\x4d"` --cubic `printf "\x49\x4b\x4e"` --cubic `printf "\x49\x4c\x4d"` --cubic `printf "\x49\x4c\x4e"` --cubic `printf "\x4a\x4b\x4d"` --cubic `printf "\x4a\x4b\x4e"` --cubic `printf "\x4a\x4c\x4d"` --cubic `printf "\x4a\x4c\x4e"` --cubic `printf "\x43\x49\x4b"` --cubic `printf "\x43\x49\x4c"` --cubic `printf "\x43\x4a\x4b"` --cubic `printf "\x43\x4a\x4c"` --cubic `printf "\x44\x49\x4b"` --cubic `printf "\x44\x49\x4c"` --cubic `printf "\x44\x4a\x4b"` --cubic `printf "\x44\x4a\x4c"` --cubic `printf "\x43\x45\x49"` --cubic `printf "\x43\x45\x4a"` --cubic `printf "\x43\x46\x49"` --cubic `printf "\x43\x46\x4a"` --cubic `printf "\x44\x45\x49"` --cubic `printf "\x44\x45\x4a"` --cubic `printf "\x44\x46\x49"` --cubic `printf "\x44\x46\x4a"` --cubic `printf "\x43\x45\x47"` --cubic `printf "\x43\x45\x48"` --cubic `printf "\x43\x46\x47"` --cubic `printf "\x43\x46\x48"` --cubic `printf "\x44\x45\x47"` --cubic `printf "\x44\x45\x48"` --cubic `printf "\x44\x46\x47"` --cubic `printf "\x44\x46\x48"` --cubic `printf "\x43\x49\x57"` --cubic `printf "\x43\x49\x58"` --cubic `printf "\x43\x4a\x57"` --cubic `printf "\x43\x4a\x58"` --cubic `printf "\x44\x49\x57"` --cubic `printf "\x44\x49\x58"` --cubic `printf "\x44\x4a\x57"` --cubic `printf "\x44\x4a\x58"` --cubic `printf "\x49\x57\x59"` --cubic `printf "\x49\x57\x5a"` --cubic `printf "\x49\x58\x59"` --cubic `printf "\x49\x58\x5a"` --cubic `printf "\x4a\x57\x59"` --cubic `printf "\x4a\x57\x5a"` --cubic `printf "\x4a\x58\x59"` --cubic `printf "\x4a\x58\x5a"` --cubic `printf "\x43\x4f\x51"` --cubic `printf "\x43\x4f\x52"` --cubic `printf "\x43\x50\x51"` --cubic `printf "\x43\x50\x52"` --cubic `printf "\x44\x4f\x51"` --cubic `printf "\x44\x4f\x52"` --cubic `printf "\x44\x50\x51"` --cubic `printf "\x44\x50\x52"` --cubic `printf "\x43\x45\x45"` --cubic `printf "\x43\x45\x46"` --cubic `printf "\x43\x46\x45"` --cubic `printf "\x43\x46\x46"` --cubic `printf "\x44\x45\x45"` --cubic `printf "\x44\x45\x46"` --cubic `printf "\x44\x46\x45"` --cubic `printf "\x44\x46\x46"` --cubic `printf "\x43\x53\x49"` --cubic `printf "\x43\x53\x4a"` --cubic `printf "\x43\x54\x49"` --cubic `printf "\x43\x54\x4a"` --cubic `printf "\x44\x53\x49"` --cubic `printf "\x44\x53\x4a"` --cubic `printf "\x44\x54\x49"` --cubic `printf "\x44\x54\x4a"` --cubic `printf "\x43\x4f\x49"` --cubic `printf "\x43\x4f\x4a"` --cubic `printf "\x43\x50\x49"` --cubic `printf "\x43\x50\x4a"` --cubic `printf "\x44\x4f\x49"` --cubic `printf "\x44\x4f\x4a"` --cubic `printf "\x44\x50\x49"` --cubic `printf "\x44\x50\x4a"` --cubic `printf "\x43\x53\x55"` --cubic `printf "\x43\x53\x56"` --cubic `printf "\x43\x54\x55"` --cubic `printf "\x43\x54\x56"` --cubic `printf "\x44\x53\x55"` --cubic `printf "\x44\x53\x56"` --cubic `printf "\x44\x54\x55"` --cubic `printf "\x44\x54\x56"` --cubic `printf "\x43\x49\x4f"` --cubic `printf "\x43\x49\x50"` --cubic `printf "\x43\x4a\x4f"` --cubic `printf "\x43\x4a\x50"` --cubic `printf "\x44\x49\x4f"` --cubic `printf "\x44\x49\x50"` --cubic `printf "\x44\x4a\x4f"` --cubic `printf "\x44\x4a\x50"` --cubic `printf "\x43\x49\x5b"` --cubic `printf "\x43\x49\x5c"` --cubic `printf "\x43\x4a\x5b"` --cubic `printf "\x43\x4a\x5c"` --cubic `printf "\x44\x49\x5b"` --cubic `printf "\x44\x49\x5c"` --cubic `printf "\x44\x4a\x5b"` --cubic `printf "\x44\x4a\x5c"` --cubic `printf "\x43\x49\x53"` --cubic `printf "\x43\x49\x54"` --cubic `printf "\x43\x4a\x53"` --cubic `printf "\x43\x4a\x54"` --cubic `printf "\x44\x49\x53"` --cubic `printf "\x44\x49\x54"` --cubic `printf "\x44\x4a\x53"` --cubic `printf "\x44\x4a\x54"`
#vowpalwabbit/vw -k --passes 3 --save_per_pass --cache_file $exp_name.cache -d $train_data --search_rollin mix_per_roll --search_task dep_parser --search 12 --search_alpha $alpha  --search_rollout oracle -f models/${exp_name} --search_history_length 3 --search_no_caching -b 26 --root_label 8 --num_label 12 --nn $nn_layers --ftrl 
#vowpalwabbit/vw -k --save_per_pass --passes 3 --cache_file $exp_name.cache -d $train_data --search_rollin mix_per_roll --search_task dep_parser --search 12 --search_alpha $alpha  --search_rollout oracle --holdout_off -f models/${exp_name}.$i --search_no_caching -b 26 --root_label 8 --num_label 12 --nn $nn_layers --ftrl
#--dparser_no_quad --dparser_no_cubic -q `printf "\x2\x4"` -q `printf "\x2\x5"` -q `printf "\x3\x4"` -q `printf "\x3\x5"` -q `printf "\x2\x8"` -q `printf "\x2\x9"` -q `printf "\x3\x8"` -q `printf "\x3\x9"` -q `printf "\x2\x2"` -q `printf "\x2\x3"` -q `printf "\x3\x2"` -q `printf "\x3\x3"` -q `printf "\x4\x4"` -q `printf "\x4\x5"` -q `printf "\x5\x4"` -q `printf "\x5\x5"` -q `printf "\x6\x6"` -q `printf "\x6\x7"` -q `printf "\x7\x6"` -q `printf "\x7\x7"` -q `printf "\x8\x8"` -q `printf "\x8\x9"` -q `printf "\x9\x8"` -q `printf "\x9\x9"` -q `printf "\xa\xa"` -q `printf "\xa\xb"` -q `printf "\xb\xa"` -q `printf "\xb\xb"` -q `printf "\xc\xc"` -q `printf "\xc\xd"` -q `printf "\xd\xc"` -q `printf "\xd\xd"` -q `printf "\x8\xa"` -q `printf "\x8\xb"` -q `printf "\x9\xa"` -q `printf "\x9\xb"` -q `printf "\x2\xe"` -q `printf "\x2\xf"` -q `printf "\x3\xe"` -q `printf "\x3\xf"` -q `printf "\x2\x12"` -q `printf "\x2\x13"` -q `printf "\x3\x12"` -q `printf "\x3\x13"` -q `printf "\x8\x16"` -q `printf "\x8\x17"` -q `printf "\x9\x16"` -q `printf "\x9\x17"` -q `printf "\x64\x2"` -q `printf "\x64\x3"` -q `printf "\x64\x4"` -q `printf "\x64\x5"` -q  `printf "\x64\x6"` -q `printf "\x64\x7"` -q `printf "\x64\x8"` -q `printf "\x64\x9"` -q `printf "\x64\xa"` -q `printf "\x64\xb"` -q `printf "\x64\xc"` -q `printf "\x64\xd"` -q `printf "\x64\x64"` --cubic `printf "\x8\xa\xc"` --cubic `printf "\x8\xa\xd"` --cubic `printf "\x8\xb\xc"` --cubic `printf "\x8\xb\xd"` --cubic `printf "\x9\xa\xc"` --cubic `printf "\x9\xa\xd"` --cubic `printf "\x9\xb\xc"` --cubic `printf "\x9\xb\xd"` --cubic `printf "\x2\x8\xa"` --cubic `printf "\x2\x8\xb"` --cubic `printf "\x2\x9\xa"` --cubic `printf "\x2\x9\xb"` --cubic `printf "\x3\x8\xa"` --cubic `printf "\x3\x8\xb"` --cubic `printf "\x3\x9\xa"` --cubic `printf "\x3\x9\xb"` --cubic `printf "\x2\x4\x8"` --cubic `printf "\x2\x4\x9"` --cubic `printf "\x2\x5\x8"` --cubic `printf "\x2\x5\x9"` --cubic `printf "\x3\x4\x8"` --cubic `printf "\x3\x4\x9"` --cubic `printf "\x3\x5\x8"` --cubic `printf "\x3\x5\x9"` --cubic `printf "\x2\x4\x6"` --cubic `printf "\x2\x4\x7"` --cubic `printf "\x2\x5\x6"` --cubic `printf "\x2\x5\x7"` --cubic `printf "\x3\x4\x6"` --cubic `printf "\x3\x4\x7"` --cubic `printf "\x3\x5\x6"` --cubic `printf "\x3\x5\x7"` --cubic `printf "\x2\x8\x16"` --cubic `printf "\x2\x8\x17"` --cubic `printf "\x2\x9\x16"` --cubic `printf "\x2\x9\x17"` --cubic `printf "\x3\x8\x16"` --cubic `printf "\x3\x8\x17"` --cubic `printf "\x3\x9\x16"` --cubic `printf "\x3\x9\x17"` --cubic `printf "\x8\x16\x18"` --cubic `printf "\x8\x16\x19"` --cubic `printf "\x8\x17\x18"` --cubic `printf "\x8\x17\x19"` --cubic `printf "\x9\x16\x18"` --cubic `printf "\x9\x16\x19"` --cubic `printf "\x9\x17\x18"` --cubic `printf "\x9\x17\x19"` --cubic `printf "\x2\xe\x10"` --cubic `printf "\x2\xe\x11"` --cubic `printf "\x2\xf\x10"` --cubic `printf "\x2\xf\x11"` --cubic `printf "\x3\xe\x10"` --cubic `printf "\x3\xe\x11"` --cubic `printf "\x3\xf\x10"` --cubic `printf "\x3\xf\x11"` --cubic `printf "\x2\x4\x4"` --cubic `printf "\x2\x4\x5"` --cubic `printf "\x2\x5\x4"` --cubic `printf "\x2\x5\x5"` --cubic `printf "\x3\x4\x4"` --cubic `printf "\x3\x4\x5"` --cubic `printf "\x3\x5\x4"` --cubic `printf "\x3\x5\x5"` --cubic `printf "\x2\x12\x8"` --cubic `printf "\x2\x12\x9"` --cubic `printf "\x2\x13\x8"` --cubic `printf "\x2\x13\x9"` --cubic `printf "\x3\x12\x8"` --cubic `printf "\x3\x12\x9"` --cubic `printf "\x3\x13\x8"` --cubic `printf "\x3\x13\x9"` --cubic `printf "\x2\xe\x8"` --cubic `printf "\x2\xe\x9"` --cubic `printf "\x2\xf\x8"` --cubic `printf "\x2\xf\x9"` --cubic `printf "\x3\xe\x8"` --cubic `printf "\x3\xe\x9"` --cubic `printf "\x3\xf\x8"` --cubic `printf "\x3\xf\x9"` --cubic `printf "\x2\x12\x14"` --cubic `printf "\x2\x12\x15"` --cubic `printf "\x2\x13\x14"` --cubic `printf "\x2\x13\x15"` --cubic `printf "\x3\x12\x14"` --cubic `printf "\x3\x12\x15"` --cubic `printf "\x3\x13\x14"` --cubic `printf "\x3\x13\x15"` --cubic `printf "\x2\x8\xe"` --cubic `printf "\x2\x8\xf"` --cubic `printf "\x2\x9\xe"` --cubic `printf "\x2\x9\xf"` --cubic `printf "\x3\x8\xe"` --cubic `printf "\x3\x8\xf"` --cubic `printf "\x3\x9\xe"` --cubic `printf "\x3\x9\xf"` --cubic `printf "\x2\x8\x1a"` --cubic `printf "\x2\x8\x1b"` --cubic `printf "\x2\x9\x1a"` --cubic `printf "\x2\x9\x1b"` --cubic `printf "\x3\x8\x1a"` --cubic `printf "\x3\x8\x1b"` --cubic `printf "\x3\x9\x1a"` --cubic `printf "\x3\x9\x1b"` --cubic `printf "\x2\x8\x12"` --cubic `printf "\x2\x8\x13"` --cubic `printf "\x2\x9\x12"` --cubic `printf "\x2\x9\x13"` --cubic `printf "\x3\x8\x12"` --cubic `printf "\x3\x8\x13"` --cubic `printf "\x3\x9\x12"` --cubic `printf "\x3\x9\x13"`
#test

vowpalwabbit/vw -t -d $test_data -i models/${exp_name}  --dparser_no_quad --dparser_no_cubic -p $tmp_file 

#Without beam search
$python_exe toJohn/parseTestResult.py $test_data_ori $tmp_file  $tag > ${tmp_file}.parse

#With beam search
#$python_exe parse_beamTestResult.py $test_data_ori $tmp_file  $tag > ${tmp_file}.parse
$python_exe toJohn/evaluate.py ${tmp_file}.parse $test_data_ori |tee -a ${exp_name}.log


#Results:
#L
#NMOD	19943	94.559	95.181	22.963
#VMOD	4785	89.864	92.121	10.265
#SUB	3945	93.485	94.550	5.439
#PMOD	1617	93.259	94.434	2.307
#AMOD	1610	77.267	83.354	7.746
#VC	1381	98.335	99.710	0.487
#OBJ	438	93.151	95.890	0.635
#PRD	349	80.802	96.848	1.418
#SBAR	311	98.714	98.714	0.085
#DEP	183	48.634	66.667	1.989
#Other	47	95.745	95.745	0.042
#R
#PMOD	3976	92.606	93.033	6.222
#VMOD	3390	73.481	77.670	19.026
#ROOT	2369	94.512	94.512	2.751
#OBJ	1522	91.853	93.298	2.624
#NMOD	1059	63.739	66.478	8.127
#SBAR	884	92.195	92.760	1.460
#PRD	483	83.851	89.027	1.651
#AMOD	462	78.788	81.818	2.074
#VC	390	94.359	97.949	0.466
#SUB	163	76.687	91.411	0.804
#Other	76	11.842	31.579	1.418
#U: 92.088
#L: 90.432

